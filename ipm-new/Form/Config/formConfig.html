<!-- form
{
  "Metadata": {
    "Id": "a499eabf-3567-4b70-86a1-a909b832fdd8",
    "Kind": "Html"
  }
}
-->
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Roboluze</title>
	<link rel="stylesheet" href="https://roboluze.com.br/_roboluze/www/css/bootstrap.5.2.3.min.css">
	<script src="https://roboluze.com.br/_roboluze/www/js/bootstrap.5.2.3.js"></script>
	<link rel="stylesheet" href="https://roboluze.com.br/_roboluze/www/css/roboluze.css">
	<script src="https://roboluze.com.br/_roboluze/www/js/ajax.jquery.3.2.0.min.js"></script>
	<script src="https://roboluze.com.br/_roboluze/www/js/roboluze.js"></script>
	<script src="https://roboluze.com.br/_roboluze/www/js/imask.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

	<script type="text/javascript">
			var uiPathApi = {
                getValue: function (elementId) {
                    // this is a callback, being called from the workflow
                    // enter your own code to get element values
                    var el = document.getElementById(elementId);
                    if (el.value == undefined) {
                        return el.innerHTML;
                    } else {
                        if (el.checked == undefined) {
                            return el.value;
                        } else {
                            return el.checked;
                        }
                    }
                },
        
                setValue: function (elementId, value) {
				
					if (elementId === 'parametros') {
						var jsonData = value;
						var data = JSON.parse(jsonData);
						
						for (var key in data) {
							if (data.hasOwnProperty(key)) {
								var el = document.getElementById(key);
								if (el) {
									if (typeof data[key] === 'boolean') {
										var label = document.querySelector('label[for="' + key + '"]');
										el.checked = data[key];
										if (key === 'filtrarClientesPendentes'){
											label.textContent = data[key] ? 'Clientes Pendentes' : 'Todos os Clientes';
										} else {
											label.textContent = data[key] ? 'Sim' : 'Não';
										}
									} else {
										el.value = data[key];
									}
								}
							}
						}
					} else if (elementId === 'listaPerfil') {
						var jsonData = value;
						var data = JSON.parse(jsonData);
						var perfilSelect  = document.getElementById('perfil');
						perfilSelect.innerHTML = '';
						data.forEach(function(item) {
						  var option = document.createElement('option');
						  option.value = item.ID_PERFIL;
						  option.text = item.PERFIL;
						  perfilSelect.appendChild(option);
						});
					} else {
						var el = document.getElementById(elementId);
						if (el == null) {
							var el = document.getElementById(value);
						} 
						if ((el.tagName === 'INPUT' && el.type === 'text') || el.type === 'email') {
							el.value = value;
						}  else if (el.tagName === 'SELECT') {
							el.value = value;
						} else {
							el.innerHTML = value;
						}
							
					}
				    
                },
				
				
                // Call this to trigger a "Form Message" event
                // This function is set by the forms engine after the page loads,
                // but declaring it here as empty helps with code autocompletion
                sendMessage: function (id, value) { },
			};
	</script>
	<script>
		function closedClicked() {
			uiPathApi.sendMessage("close");
		}
		function changedPerfil(perfil) {
			
			var jsonData = {
				"perfil": perfil
			};

			var jsonString = JSON.stringify(jsonData);
			//alert(jsonString);
			uiPathApi.sendMessage("perfil", jsonString );
		}
		function startClicked() {
			var perfil = document.getElementById("perfil").value;
			var periodo = document.getElementById("periodo").value;
			var exibirClientes = document.getElementById("exibirClientes").checked;
			var filtrarClientesPendentes = document.getElementById("filtrarClientesPendentes").checked;
			var downloadNFSaida = document.getElementById("downloadNFSaida").checked;
			var protocolarNFSaida = document.getElementById("protocolarNFSaida").checked;
			var downloadNFEntrada = document.getElementById("downloadNFEntrada").checked;
			var protocolarNFEntrada = document.getElementById("protocolarNFEntrada").checked;
			var simplesNacional = document.getElementById("simplesNacional").checked;
			var emitirNFS = document.getElementById("emitirNFS").checked;
			
			var jsonData = {
				"perfil": perfil,
				"periodo": periodo,
				"exibirClientes": exibirClientes,
				"filtrarClientesPendentes": filtrarClientesPendentes,
				"downloadNFSaida": downloadNFSaida,
				"protocolarNFSaida": protocolarNFSaida,
				"downloadNFEntrada": downloadNFEntrada,
				"protocolarNFSaida": protocolarNFSaida,
				"protocolarNFEntrada": protocolarNFEntrada,
				"simplesNacional": simplesNacional,
				"emitirNFS": emitirNFS
			};

			var jsonString = JSON.stringify(jsonData);
			//alert(jsonString);
			//alert("Ok");
			uiPathApi.sendMessage("start", jsonString );
		}
		function addPerfilClicked(){
			uiPathApi.sendMessage("addPerfil");
		}
		
	</script>
</head>
<body class="body">
	<div class="container-fluid mt-2">
		<div class="row">
			<div class="col-sm-7">
				<div class="d-flex align-items-center mb-3">
					<img src="https://roboluze.com.br/img/evoluze_logo.png" alt="Logo" class="logo">
					<h4 class="m-0" id="title">Roboluze - Folha</h4>
			   </div>
			</div>
			<div class="col-sm-4">
				<ul class="nav nav-pills nav-justified" id="pills-tab" role="tablist">
				  <li class="nav-item">
					<a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Home</a>
				  </li>
				  <li class="nav-item">
					<a class="nav-link" id="pills-parametro-tab" data-toggle="pill" href="#pills-parametro" role="tab" aria-controls="pills-parametro" aria-selected="false">Parametro</a>
				  </li>
				</ul>
			</div>
			<div class="col-sm-1">
				<button type="button" class="btn-close float-end" aria-label="Close" onclick="closedClicked()"></button>
			</div>
		</div>
		<hr class="my-1">
		<div class="container-fluid mt-2">
			<div class="tab-content" id="pills-tabContent">
				<div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
					<form class="needs-validation rneeds-validation">
						<div class="row g-3">
							<div class="col-3 d-flex align-items-center">
								<label for="periodo" class="col-form-label">Período</label>
							</div>
							<div class="col-2 d-flex align-items-center ">
								<input type="text" class="form-control form-control-sm" id="periodo" name="periodo" placeholder="" value="">
							</div>
							<div class="col-1 d-flex align-items-center "></div>
							<div class="col-2 align-items-center">
								<label for="periodo" class="col-form-label">Perfil</label>
							</div>
							<div class="col-4 d-flex align-items-center">
								<select class="form-select  form-select-sm" id="perfil">
								</select>
								<div class="d-flex align-items-center justify-content-end">
									<div class="d-grid">
										<button id="addPerfil" type="submit" class="btn btn-primary btn-sm" onclick="addPerfilClicked()">
										<i class="bi bi-person-plus-fill"></i>
										</button>
									</div>
								</div>
							</div>
						</div>
						<div class="row g-3">
							<div class="col-3 d-flex align-items-center">
								<label for="periodo" class="col-form-label">Exibir clientes</label>
							</div>
							<div class="col-2 d-flex align-items-center ">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="exibirClientes" name="exibirClientes" checked>
									<label class="form-check-label" for="exibirClientes">Sim</label>
								</div>
							</div>
							<div class="col-1 d-flex align-items-center "></div>
							<div class="col-2 d-flex align-items-center">
								<label for="periodo" class="col-form-label">Filtrar</label>
							</div>
							<div class="col-4 d-flex align-items-center ">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="filtrarClientesPendentes" name="filtrarClientesPendentes" checked>
									<label class="form-check-label" for="filtrarClientesPendentes">Clientes pendentes</label>
								</div>
							</div>
							
						</div>
						<hr class="my-3">
						<div class="row g-3">
							<div class="col-3 d-flex align-items-center">
								<label for="periodo" class="col-form-label">Download NFs Saída</label>
							</div>
							<div class="col-2 d-flex align-items-center ">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="downloadNFSaida" name="downloadNFSaida" checked>
									<label class="form-check-label" for="downloadNFSaida">Sim</label>
								</div>
							</div>
							<div class="col-1 d-flex align-items-center "></div>
							<div class="col-2 d-flex align-items-center">
								<label for="periodo" class="col-form-label">Protocolar Saídas</label>
							</div>
							<div class="col-4 d-flex align-items-center ">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="protocolarNFSaida" name="protocolarNFSaida" checked>
									<label class="form-check-label" for="protocolarNFSaida">Sim</label>
								</div>
							</div>
						</div>
						<div class="row g-3">
							<div class="col-3 d-flex align-items-center">
								<label for="periodo" class="col-form-label">Download NFs Entrada</label>
							</div>
							<div class="col-2 d-flex align-items-center ">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="downloadNFEntrada" name="downloadNFEntrada"checked>
									<label class="form-check-label" for="downloadNFEntrada">Sim</label>
								</div>
							</div>
							<div class="col-1 d-flex align-items-center "></div>
							<div class="col-2 d-flex align-items-center">
								<label for="periodo" class="col-form-label">Protocolar Entradas</label>
							</div>
							<div class="col-4 d-flex align-items-center ">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="protocolarNFEntrada" name="protocolarNFEntrada"checked>
									<label class="form-check-label" for="protocolarNFEntrada">Sim</label>
								</div>
							</div>
						</div>
						<div class="row g-3">
							<div class="col-3 d-flex align-items-center">
								<label for="periodo" class="col-form-label">Informar Simples Nacional</label>
							</div>
							<div class="col-2 d-flex align-items-center ">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="simplesNacional" name="simplesNacional">
									<label class="form-check-label" for="simplesNacional">Sim</label>
								</div>
							</div>
							<div class="col-1 d-flex align-items-center "></div>
							<div class="col-2 d-flex align-items-center">
								<label for="periodo" class="col-form-label">Emitir NFS</label>
							</div>
							<div class="col-4 d-flex align-items-center ">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="emitirNFS" name="emitirNFS">
									<label class="form-check-label" for="emitirNFS">Sim</label>
								</div>
							</div>
						</div>
						
						<hr class="my-3">
						<div class="d-grid">
							<button id="SubmitButton" type="submit" class="btn btn-primary" onclick="startClicked()">Iniciar Automação</button>
						</div>
					
					</form>
				</div>
			
			<div class="tab-pane fade" id="pills-parametrox" role="tabpanel" aria-labelledby="pills-parametrox-tab">
				<form class="needs-validation rneeds-validation" novalidate onsubmit="handleFormSubmit(event)">
					<div class="row g-3">
						<div class="col-sm-3">
							<label for="cnpj" class="form-label">CNPJ</label>
							<input type="text" class="form-control" id="cnpj" name="cnpj" placeholder="" value="" disabled>
						</div>

						<div class="col-sm-9">
							<label for="razaoSocial" class="form-label">Razão Social</label>
							<input type="text" class="form-control" id="razaoSocial" placeholder="" value="" required>
							<div class="invalid-feedback">Campo Obrigatório</div>
						</div>
						
						<div class="col-sm-3">
							<label for="ie" class="form-label">Inscrição Estadual</label>
							<input type="text" class="form-control" id="ie" placeholder="" value="ISENTO" required>
							<div class="invalid-feedback">Campo Obrigatório</div>
						</div>

						<div class="col-sm-9">
							<label for="nomeFantasia" class="form-label">Nome Fantasia</label>
							<input type="text" class="form-control" id="nomeFantasia" placeholder="" value="" required>
							<div class="invalid-feedback">Campo Obrigatório</div>
						</div>
						
						<div class="col-sm-12">
							<label for="email" class="form-label">Email <!--span class="text-body-secondary">(Optional)</span--></label>
							<input type="email" class="form-control" id="email" placeholder="financeiro@example.com">
							<div class="invalid-feedback">Informe um email válido!</div>
						</div>
						
						<div class="col-sm-12">
							<label for="endereco" class="form-label">Endereço</label>
							<input type="text" class="form-control" id="endereco" placeholder="" value="" required>
							<div class="invalid-feedback">Campo Obrigatório</div>
						</div>
						
						<div class="col-sm-3">
							<label for="cep" class="form-label">CEP</label>
							<input type="text" class="form-control" id="cep" placeholder="" required>
							<div class="invalid-feedback">Campo Obrigatório</div>
						</div>
						
						<div class="col-sm-7">
							<label for="cidade" class="form-label">Cidade</label>
							<input type="text" class="form-control" id="cidade" placeholder="" value="" required>
							<div class="invalid-feedback">Campo Obrigatório</div>
						</div>
						
						<div class="col-sm-2">
							<label for="uf" class="form-label">UR</label>
							<select class="form-select" id="uf" required>
								<option value=""></option>
								<option value="AC">Acre</option>
								<option value="AL">Alagoas</option>
								<option value="AP">Amapá</option>
								<option value="AM">Amazonas</option>
								<option value="BA">Bahia</option>
								<option value="CE">Ceará</option>
								<option value="DF">Distrito Federal</option>
								<option value="ES">Espírito Santo</option>
								<option value="GO">Goiás</option>
								<option value="MA">Maranhão</option>
								<option value="MT">Mato Grosso</option>
								<option value="MS">Mato Grosso do Sul</option>
								<option value="MG">Minas Gerais</option>
								<option value="PA">Pará</option>
								<option value="PB">Paraíba</option>
								<option value="PR">Paraná</option>
								<option value="PE">Pernambuco</option>
								<option value="PI">Piauí</option>
								<option value="RJ">Rio de Janeiro</option>
								<option value="RN">Rio Grande do Norte</option>
								<option value="RS">Rio Grande do Sul</option>
								<option value="RO">Rondônia</option>
								<option value="RR">Roraima</option>
								<option value="SC">Santa Catarina</option>
								<option value="SP">São Paulo</option>
								<option value="SE">Sergipe</option>
								<option value="TO">Tocantins</option>
							</select>
							<div class="invalid-feedback">Please select a valid country.</div>
						</div>
					   
						<div class="d-grid">
							<button id="SubmitButton" type="submit" class="btn btn-primary" onclick="saveClicked()">Salvar</button>
						</div>
					</div>
				</form>
			</div>
			<div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">Contato</div>
		</div>
		
		</div>
		
		
		  
	<script>
		
	</script>
	<script>
	  var ckExibirClientes = document.getElementById('exibirClientes');
	  var labelExibirClientes = document.querySelector('label[for="exibirClientes"]');

	  ckExibirClientes.addEventListener('change', function() {
		if (this.checked) {
		  labelExibirClientes.textContent = 'Sim';
		} else {
		  labelExibirClientes.textContent = 'Não';
		}
	  });
	  var ckFiltroClientes = document.getElementById('filtrarClientesPendentes');
	  var labelFiltro = document.querySelector('label[for="filtrarClientesPendentes"]');

	  ckFiltroClientes.addEventListener('change', function() {
		if (this.checked) {
		  labelFiltro.textContent = 'Clientes pendentes';
		} else {
		  labelFiltro.textContent = 'Todos os clientes';
		}
	  });
	  
	  var ckDownloadNFSaida = document.getElementById('downloadNFSaida');
	  var labelDownloadNFSaida = document.querySelector('label[for="downloadNFSaida"]');

	  ckDownloadNFSaida.addEventListener('change', function() {
		if (this.checked) {
		  labelDownloadNFSaida.textContent = 'Sim';
		} else {
		  labelDownloadNFSaida.textContent = 'Não';
		}
	  });
	  
	  var ckProtocolarNFSaida = document.getElementById('protocolarNFSaida');
	  var labelProtocolarNFSaida = document.querySelector('label[for="protocolarNFSaida"]');

	  ckProtocolarNFSaida.addEventListener('change', function() {
		if (this.checked) {
		  labelProtocolarNFSaida.textContent = 'Sim';
		} else {
		  labelProtocolarNFSaida.textContent = 'Não';
		}
	  });
	  
	  var ckDownloadNFEntrada = document.getElementById('downloadNFEntrada');
	  var labelDownloadNFEntrada = document.querySelector('label[for="downloadNFEntrada"]');

	  ckDownloadNFEntrada.addEventListener('change', function() {
		if (this.checked) {
		  labelDownloadNFEntrada.textContent = 'Sim';
		} else {
		  labelDownloadNFEntrada.textContent = 'Não';
		}
	  });
	  
	  var ckProtocolarNFEntrada = document.getElementById('protocolarNFEntrada');
	  var labelProtocolarNFEntrada = document.querySelector('label[for="protocolarNFEntrada"]');

	  ckProtocolarNFEntrada.addEventListener('change', function() {
		if (this.checked) {
		  labelProtocolarNFEntrada.textContent = 'Sim';
		} else {
		  labelProtocolarNFEntrada.textContent = 'Não';
		}
	  });
	  
	  var ckSimplesNacional = document.getElementById('simplesNacional');
	  var labelSimplesNacional = document.querySelector('label[for="simplesNacional"]');

	  ckSimplesNacional.addEventListener('change', function() {
		if (this.checked) {
		  labelSimplesNacional.textContent = 'Sim';
		} else {
		  labelSimplesNacional.textContent = 'Não';
		}
	  });
	  
	  var ckEmitirNFS = document.getElementById('emitirNFS');
	  var labelEmitirNFS = document.querySelector('label[for="emitirNFS"]');

	  ckEmitirNFS.addEventListener('change', function() {
		if (this.checked) {
		  labelEmitirNFS.textContent = 'Sim';
		} else {
		  labelEmitirNFS.textContent = 'Não';
		}
	  });
	  
	  
	  var selectPerfil = document.getElementById('perfil');

	// Define a função que será executada quando o valor selecionado for alterado
	function perfilChanged() {
	  var selectedValue = selectPerfil.value;
	  //alert(selectedValue);
	  changedPerfil(selectedValue);
	}

	// Adiciona um ouvinte de evento para o evento 'change' do <select>
	selectPerfil.addEventListener('change', perfilChanged);
	  
	  
	  document.addEventListener("DOMContentLoaded", function () {
		  var cpf = formatarInput('periodo','00/0000');
		});
		
	  $(document).ready(function() {
		$('.nav-link').click(function() {
		  // Remove a classe 'active' de todas as abas
		  $('.nav-link').removeClass('active');

		  // Adicione a classe 'active' à aba clicada
		  $(this).addClass('active');

		  // Recupere o ID do painel a ser exibido
		  var panelId = $(this).attr('href');

		  // Oculte todos os painéis
		  $('.tab-pane').removeClass('show active');

		  // Exiba o painel correspondente ao ID
		  $(panelId).addClass('show active');
		});
	  });
	</script>
	<script src="https://roboluze.com.br/_roboluze/www/js/jquery-3.6.0.min.js"></script>
	<script src="https://roboluze.com.br/_roboluze/www/js/bootpag.js"></script>
	
</body>
</html>
