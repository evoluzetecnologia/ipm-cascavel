<!-- form
{
  "Metadata": {
    "Id": "a499eabf-3567-4b70-86a1-a909b832fdd8",
    "Kind": "Html"
  }
}
-->
<!DOCTYPE html>
<html lang="pt-BR" data-bs-theme="auto">
  <head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Roboluze</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.6/jquery.inputmask.min.js"></script>
	<script src="https://roboluze.com.br/_roboluze/www/js/ajax.jquery.3.2.0.min.js"></script>
	
	
	<style>
		body {
			padding-top: 4.5rem;
		}
		#fileInfoCertidaoExcel {
			display: none;
		}
	</style>
	
	<script type="text/javascript">
		var uiPathApi = {
			getValue: function (elementId) {
				// this is a callback, being called from the workflow
				// enter your own code to get element values
				var el = document.getElementById(elementId);
				if (el.value == undefined) {
					return el.innerHTML;
				} else {
					if (el.checked == undefined) {
						return el.value;
					} else {
						return el.checked;
					}
				}
			},
	
			setValue: function (elementId, value) {
				
				if (elementId === 'financeiro'){
					if (value === 'Fatura'){
						var divElement = document.createElement('div');
						  divElement.classList.add('row');
						  var linkElement = document.createElement('a');
						  linkElement.classList.add('btn', 'btn-full', 'btn-warning');
						  linkElement.href = '#';
						  linkElement.textContent = 'Sua fatura já está disponível aqui!';

						  divElement.appendChild(linkElement);
						  var containerElement = document.getElementById('financeiro');
						  containerElement.appendChild(divElement);
						
					
					} else if (value === 'Atencao' || value === 'Bloqueado')  {
					  
					  var texto = 'Atenção! Sua licença está expirada, efetue o pagamento da fatura para liberar todas as funções da automação.'
					  if (value === 'Bloqueado'){
						var texto = 'Atenção! O seu sistema está bloqueado no momento, efetue o pagamento para continuar usando as automações'
					  }
					  
					  var spanElement = document.createElement('span');
					  spanElement.classList.add('d-block', 'p-1', 'text-bg-danger');
					  spanElement.textContent = texto;

					  var linkElement = document.createElement('a');
					  linkElement.classList.add('btn', 'btn-light', 'btn-sm');
					  linkElement.href = '#';
					  linkElement.textContent = 'Gerar Fatura Online';

					  spanElement.appendChild(linkElement);
					  var containerElement = document.getElementById('financeiro');
					  containerElement.appendChild(spanElement);
					}
					
					
				} else if (elementId === 'parametros') {
					var jsonData = value;
					var data = JSON.parse(jsonData);
					
					for (var key in data) {
						if (data.hasOwnProperty(key)) {
							var el = document.getElementById(key);
							if (el == null) {
								var elements = document.querySelectorAll('[name="' + key + '"]');
								el = elements[0];
							}
							if (el) {
								if (el.tagName === 'INPUT' && el.type === 'radio') {
									var radioButtonXML = document.getElementById(key + 'XML');
									var radioButtonTXT = document.getElementById(key + 'TXT');
									if (data[key] === 'XML') {
										radioButtonXML.checked = true;
										radioButtonTXT.checked = false;
									} else {
										radioButtonXML.checked = false;
										radioButtonTXT.checked = true;
									}
								} else if (typeof data[key] === 'boolean') {
									var label = document.querySelector('label[for="' + key + '"]');
									el.checked = data[key];
									
									if (key === 'EmitirNFS'){
										if (data[key]){
											document.getElementById("divEmissaoNF").style.display = "block";
											document.getElementById("divCertidao").style.display = "none";
										} else {
											document.getElementById("divEmissaoNF").style.display = "none";
											document.getElementById("divCertidao").style.display = "block";
										}
									}
									
									if (key === 'FiltrarClientesPendentes'){
										label.textContent = data[key] ? 'Clientes Pendentes' : 'Todos os Clientes';
									} else {
										label.textContent = data[key] ? 'Sim' : 'Não';
									}
								}  else {
									el.value = data[key];
								}
							}
						}
					}
				} else if (elementId === 'dominio') {
					var jsonData = value;
					var data = JSON.parse(jsonData);
					
					for (var key in data) {
						if (data.hasOwnProperty(key)) {
							var el = document.getElementById(key);
							if (el) {
								if (typeof data[key] === 'boolean') {
									var label = document.querySelector('label[for="' + key + '"]');
									el.checked = data[key];
									label.textContent = data[key] ? 'Sim' : 'Não';
								} else {
									el.value = data[key];
								}
							}
						}
					}
				} else if (elementId === 'listaPerfil') {
					var jsonData = value;
					var data = JSON.parse(jsonData);
					var perfilSelect  = document.getElementById('Perfil');
					
					while (perfilSelect.options.length > 0) {
					  perfilSelect.remove(0);
					}
					perfilSelect.innerHTML = '';
					
					var tabela = document.getElementById('myTablePerfil');
					
					while (tabela.rows.length > 0) {
						tabela.deleteRow(0);
					}
					
					var tableBody = $("#myTablePerfil");
					
					data.forEach(function(item) {
						
						if (item.SITUACAO) {
							var option = document.createElement('option');
							option.value = item.ID_PERFIL;
							option.text = item.PERFIL;
						  perfilSelect.appendChild(option);
						}
					  
					 
						var row = $('<tr>');
						
						
						var codigoInput = $('<input>').attr('type', 'text').prop('class', 'form-control form-control-sm').prop('id', 'ID_PERFIL').prop('name', 'ID_PERFIL').prop("value",item.ID_PERFIL).prop('readonly', true);
						var codigoCell = $("<td>").prop('class', 'col-2 fw-normal').append(codigoInput);
						row.append(codigoCell);
										
						var perfilInput = $('<input>').attr('type', 'text').prop('class', 'form-control form-control-sm').prop('id', 'PERFIL').prop('name', 'PERFIL').prop("value",item.PERFIL);
						var perfilCell = $("<td>").prop('class', 'col-10').append(perfilInput);
						row.append(perfilCell);
						
						//Ativou ou Inativo
						var td = $('<td>').prop('class', 'col-2 fw-normal');
						var div = $('<div>').prop('class', 'd-flex justify-content-center');
						var formCheck = $('<div>').prop('class', 'form-check form-switch form-check-inline');
						var input = $('<input>').prop('class', 'form-check-input SITUACAO').attr('type', 'checkbox').attr('role', 'switch').attr('id', 'SITUACAO_'+ item.ID_PERFIL).attr('name', 'SITUACAO_'+ item.ID_PERFIL);
						if (item.SITUACAO) {
						  input.prop('checked', true);
						}
						var label = $('<label>').prop('class', 'form-check-label').attr('for', 'SITUACAO_'+ item.ID_PERFIL).text(item.SITUACAO ? 'Ativo' : 'Inativo');
						formCheck.append(input, label);
						div.append(formCheck);
						td.append(div);
						row.append(td);
						
						tableBody.append(row);
						
						$('.btn-excluir-perfil').click(function() {
						  var id = $(this).attr('id');
						  excluirPerfil(id);
						});
						
					  
					});
					
					var ckPerfilSituacao = document.querySelectorAll('input[id^="SITUACAO_"]');
						ckPerfilSituacao.forEach(function(checkbox) {
						  var labelPerfil = document.querySelector('label[for="' + checkbox.id + '"]');

						  checkbox.addEventListener('change', function() {
							if (this.checked) {
							  labelPerfil.textContent = 'Sim';
							} else {
							  labelPerfil.textContent = 'Não';
							}
						  });
						});
					
				} else {
					var el = document.getElementById(elementId);
					if (el == null) {
						var el = document.getElementById(value);
					} 
					if ((el.tagName === 'INPUT' && el.type === 'text') || el.type === 'email') {
						el.value = value;
					} else if (el.tagName === 'INPUT' && el.type === 'file') {
						el.value = value;
					} else if (el.tagName === 'SELECT') {
						el.value = value;
					}  else {
						el.innerHTML = value;
					}			
				}
				
			},
			
			sendMessage: function (id, value) { },
		};
	</script>
	<script>
		
		function certidaoExcelClicked() {
			var jsonString = JSON.stringify(jsonData());
			uiPathApi.sendMessage("certidao", jsonString);
		}
	
		function addNovoPerfilClicked(){
			var perfilNome = document.getElementById("novoPerfil").value;
			if (perfilNome !== null && perfilNome !== '') {
				var jsonData = {
					"Perfil": perfilNome
				}
				var jsonString = JSON.stringify(jsonData);
				uiPathApi.sendMessage("addPerfil", jsonString );
			}
		}
		function atualizaPerfil(value){
			
			var jsonData = [];
			$('table tr').each(function() {
				var row = $(this);
				var ID_PERFIL = row.find("#ID_PERFIL").val();
				var PERFIL = row.find("#PERFIL").val();
				var SITUACAO = row.find(".SITUACAO").is(":checked");
				
				var rowValues = {
				  'ID_PERFIL': ID_PERFIL,
				  'PERFIL': PERFIL,
				  'SITUACAO': SITUACAO
				};
				if(ID_PERFIL){
					jsonData.push(rowValues);
				}
			});
			var jsonResult = JSON.stringify(jsonData);
			uiPathApi.sendMessage("atualizarPerfil", jsonResult);
			/*
			var jsonData = {
				"idPerfil": value
			}
			var jsonString = JSON.stringify(jsonData);
			alert(perfil);
			uiPathApi.sendMessage("excluirPerfil", jsonString );
			*/
		}
		function closedClicked() {
			uiPathApi.sendMessage("close");
		}
		function changedPerfil(perfil) {
			var jsonDataObj = jsonData();
			
			jsonDataObj['Perfil'] = perfil;
			var jsonString = JSON.stringify(jsonDataObj);
			uiPathApi.sendMessage("perfil", jsonString );
		}
		
		function excelClicked(){
			uiPathApi.sendMessage("clientesExcel");
		}
		
		function startClicked() {
			var jsonString = JSON.stringify(jsonData());
			uiPathApi.sendMessage("start", jsonString);
		}
		
		function jsonData(){
			var emitirNFS = document.getElementById("EmitirNFS").checked;
			var certidaoExcel = '';
			var arquivoNotas = '';
			
			if (emitirNFS){
				var fileInput = document.getElementById('fileInputEmissaoNFS');
				var file = fileInput.files[0];
				if(file){
					var fileName = file.name;
					var fileExtension = fileName.split('.').pop(); // Obtém a extensão do arquivo
					var currentDate = new Date();
					var formattedDate = currentDate.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit' });
					arquivoNotas = formattedDate.replace(/[^\d]/g, '') + '.' + fileExtension; // Novo nome do arquivo
					
					var downloadLink = document.createElement('a');
					downloadLink.href = URL.createObjectURL(file);
					downloadLink.download = arquivoNotas;
					downloadLink.click();
				}
			} else {
				var fileInput = document.getElementById('fileInputCertidao');
				var file = fileInput.files[0];
				if(file){
					var fileName = file.name;
					var fileExtension = fileName.split('.').pop(); // Obtém a extensão do arquivo
					var currentDate = new Date();
					var formattedDate = currentDate.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit' });
					certidaoExcel = formattedDate.replace(/[^\d]/g, '') + '.' + fileExtension; // Novo nome do arquivo
					
					var downloadLink = document.createElement('a');
					downloadLink.href = URL.createObjectURL(file);
					downloadLink.download = certidaoExcel;
					downloadLink.click();
				}
			}
			
			
			var perfil = document.getElementById("Perfil").value;
			var periodo = document.getElementById("Periodo").value;
			var exibirClientes = document.getElementById("ExibirClientes").checked;
			var filtrarClientesPendentes = document.getElementById("FiltrarClientesPendentes").checked;
			var downloadNFSaida = document.getElementById("DownloadNFSaida").checked;
			var protocolarNFSaida = document.getElementById("ProtocolarNFSaida").checked;
			var downloadNFEntrada = document.getElementById("DownloadNFEntrada").checked;
			var protocolarNFEntrada = document.getElementById("ProtocolarNFEntrada").checked;
			var simplesNacional = document.getElementById("SimplesNacional").checked;
			
			var FinalidadeCertidao = document.getElementById("FinalidadeCertidao").value;
			//var certidaoExcel = document.getElementById("CertidaoExcel").value;
			//var input = document.getElementById("CertidaoExcel");
			//var certidaoExcel = input.files[0].name;
			//var fileInfoCertidaoExcelDiv = document.getElementById('fileInfoCertidaoExcel');
			//var certidaoExcel = fileInfoCertidaoExcelDiv.value;
			
			
			var codigoServico = document.getElementById("CodigoServico").value;
			var observacaoNFS = document.getElementById("ObservacaoNFS").value;
			var observacaoFinanceira = document.getElementById("ObservacaoFinanceira").value;
			
			// IPM Parametros
			var ipmLogin = document.getElementById("IPMLogin").value;
			var ipmPassword = document.getElementById("IPMPassword").value;
			var ipmCodigoLogin = document.getElementById("IPMCodigoLogin").value;
			var ProtocoloSaida = document.getElementById("ProtocoloSaida").value;
			var ProtocoloEntrada = document.getElementById("ProtocoloEntrada").value;
			
			var radios = document.getElementsByName('ArquivoSaida');
			var ArquivoSaida;
			for (var i = 0; i < radios.length; i++) {
				if (radios[i].checked) {
					ArquivoSaida = radios[i].id.replace('ArquivoSaida', '');
					//console.log(DOWNLOAD_SAIDA);
					break;
				}
			}
			radios = document.getElementsByName('ArquivoEntrada');
			var ArquivoEntrada;
			for (var i = 0; i < radios.length; i++) {
				if (radios[i].checked) {
					ArquivoEntrada = radios[i].id.replace('ArquivoEntrada', '');
					//console.log(DOWNLOAD_SAIDA);
					break;
				}
			}
			/*
			var elPrestados = document.getElementById("ArquivoSaidaXML");
			if (elPrestados.checked) {
				var ArquivoSaida = "XML";
			} else {
				var ArquivoSaida = "TXT";
			}
			
			
			var elTomados = document.getElementById("ArquivoEntradaXML");
			if (elTomados.checked) {
				var ArquivoEntrada = "XML";
			} else {
				var ArquivoEntrada = "TXT";
			}
			*/
			
			//Dominio Parametros
			var dominioLogin = document.getElementById("DominioLogin").value;
			var dominioPassword = document.getElementById("DominioPassword").value;
			var dominioWeb = document.getElementById("DominioWeb").checked;
			
			var jsonData = {
				"Perfil": perfil,
				"Periodo": periodo,
				"ExibirClientes": exibirClientes,
				"FiltrarClientesPendentes": filtrarClientesPendentes,
				"DownloadNFSaida": downloadNFSaida,
				"DownloadNFEntrada": downloadNFEntrada,
				"ProtocolarNFSaida": protocolarNFSaida,
				"ProtocolarNFEntrada": protocolarNFEntrada,
				"SimplesNacional": simplesNacional,
				"EmitirNFS": emitirNFS,
				"FinalidadeCertidao": FinalidadeCertidao,
				"CertidaoExcel": certidaoExcel,
				"ArquivoNotas": arquivoNotas,
				
				"CodigoServico": codigoServico,
				"ObservacaoNFS": observacaoNFS,
				"ObservacaoFinanceira": observacaoFinanceira,
				
				"IPMLogin": ipmLogin,
				"IPMPassword": ipmPassword,
				"IPMCodigoLogin": ipmCodigoLogin,
				"ProtocoloSaida": ProtocoloSaida,
				"ProtocoloEntrada": ProtocoloEntrada,				
				"ArquivoSaida": ArquivoSaida,
				"ArquivoEntrada": ArquivoEntrada,
				
				"DominioWeb": dominioWeb,
				"DominioLogin": dominioLogin,
				"DominioPassword": dominioPassword				
				
			};
			return jsonData;
		}
		
		
		
	</script>
</head>
<body >
	<div id="financeiro"></div>
	
	<!--span class="d-block p-1 text-bg-danger">
		Atenção! sua lisença está expirada, efetue o pagamento da fatura para liberar todas as função da automação.
		<a class="btn btn-light btn-sm" href="#" role="button">Gerar Fatura Online</a>
	</span>
	
	<div class="row"> 
		<a class="btn btn-full btn-warning" href="#" role="button">
			Sua fatura já está dispinível aqui!	
		</a>
	</div-->
	
	<!--Menu automação -->
	<nav class="navbar navbar-dark fixed-top bg-primary ">
    	<div class="container-fluid">
			<div class="col-7">
				<div class="d-flex justify-content-strat align-items-center">
					<img src="https://roboluze.com.br/img/evoluze_logo_white_ligth.png" width="35" height="35" class="me-2" alt="Roboluze">
					 <a class="navbar-brand" href="#pills-iniciar"><h5 class="mb-0"  id="title">Roboluze</h5></a>
				</div>
			</div>
			<div class="col-4 d-flex me-0">
				<select class="form-select me-2" id="Perfil"></select>
				<div class="d-flex align-items-center justify-content-end">
					<div class="d-grid">
						<button id="addPerfil" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#perfilModal">
							<i class="bi bi-person-plus-fill"></i>
						</button>
					</div>
				</div>
			</div>
			<button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#menuButton" aria-controls="menuButton" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>		
		 
			<!-- Item do Menu -->
			<div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="menuButton" aria-labelledby="menuButtonLabel">
				<div class="offcanvas-header">
					<img src="https://roboluze.com.br/img/evoluze_logo_white_ligth.png" width="20" height="20" class="me-2" alt="Roboluze">
					<h5 class="offcanvas-title" id="menuButtonLabel">Configurações</h5>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
				</div>
				<div class="offcanvas-body" id="pills-iniciar-tab">
					<ul class="navbar-nav justify-content-end flex-grow-1 pe-3" id="pills-tab" role="tablist">
						<li class="nav-item">
						  <button class="nav-link active" id="pills-iniciar-tab" data-bs-toggle="pill" data-bs-target="#pills-iniciar" type="button" role="tab" aria-controls="pills-iniciar" aria-selected="true">Home</button>
						</li>
						<li class="nav-item">
						  <button class="nav-link" id="pills-automacao-tab" data-bs-toggle="pill" data-bs-target="#pills-automacao" type="button" role="tab" aria-controls="pills-automacao" aria-selected="true">IPM</button>
						</li>
						
						<li class="nav-item dropdown" role="presentation">
							<button class="nav-link dropdown-toggle" type="button" role="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
								Domínio Sistema
							</button>
						  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton" data-bs-theme="dark">
							
							<li><a class="dropdown-item" id="pills-dominio-tab" data-bs-target="#pills-dominio" role="tab" aria-controls="pills-dominio" aria-selected="false">Geral</a></li>
							<li><hr class="dropdown-divider"></li>
						  </ul>
						</li>
						<li class="nav-item">
						  <a class="nav-link" href="#pills-automacao"></a>
						   <hr class="dropdown-divider">
						</li>
					</ul>
					<button class="btn btn-outline-danger w-100" type="botton" onclick="closedClicked()">Sair da Automação</button>
				</div>
			</div>
		</div>
	</nav>
	
	
	<!--Corpo Automação-->
	<div class="container overflow-auto" style="max-height: 600px;">
        <div class="card tab-content" id="pills-tabContent" >
			<div class="card-body tab-pane show active" id="pills-iniciar" role="tabpanel" aria-labelledby="pills-iniciar-tab" tabindex="0">
				<div class="container-fluid d-flex justify-content-center"><h5>Filtros</h5></div>
				<div class="row align-items-center">
					<div class="col-6">
						<div class="row">
							<div class="col-2 d-flex align-items-center">
								<label class="col-form-label">Período</label>
							</div>
							<div class="col-3 d-flex align-items-center">
								<input type="text" class="form-control form-control-sm" id="Periodo" name="Periodo" data-inputmask="'mask': '99/9999'" placeholder="" value="">
								
							</div>
						</div>
					</div>
					<div class="col-6" >
						<div class="row">
							<div class="col-3 d-flex align-items-center">
								<label class="col-form-label">Exibir clientes</label>
							</div>
							<div class="col-8 d-flex align-items-center">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="ExibirClientes" name="ExibirClientes" checked>
									<label class="form-check-label" for="ExibirClientes">Sim</label>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-3 d-flex align-items-center">
								<label class="col-form-label">Automatizar</label>
							</div>
							<div class="col-8 d-flex align-items-center">
								<div class="form-check form-switch form-check-inline">
									<input class="form-check-input" type="checkbox" role="switch" id="FiltrarClientesPendentes" name="FiltrarClientesPendentes" checked>
									<label class="form-check-label" for="FiltrarClientesPendentes">Clientes pendentes</label>
								</div>
							</div>
						</div>
					</div>
					
				</div>
				<hr class="my-3">
				<div class="container-fluid d-flex justify-content-center"><h6>Tarefas da Automação</h6></div>
				<div>
					<div class="row">
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">Download NFs Saída</label>
						</div>
						<div class="col-2 d-flex align-items-center ">
							<div class="form-check form-switch form-check-inline">
								<input class="form-check-input" type="checkbox" role="switch" id="DownloadNFSaida" name="DownloadNFSaida" checked>
								<label class="form-check-label" for="DownloadNFSaida">Sim</label>
							</div>
						</div>
						<div class="col-1 d-flex align-items-center "></div>
						<div class="col-2 d-flex align-items-center">
							<label class="col-form-label">Protocolar Saídas</label>
						</div>
						<div class="col-4 d-flex align-items-center ">
							<div class="form-check form-switch form-check-inline">
								<input class="form-check-input" type="checkbox" role="switch" id="ProtocolarNFSaida" name="ProtocolarNFSaida" checked>
								<label class="form-check-label" for="ProtocolarNFSaida">Sim</label>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">Download NFs Entrada</label>
						</div>
						<div class="col-2 d-flex align-items-center ">
							<div class="form-check form-switch form-check-inline">
								<input class="form-check-input" type="checkbox" role="switch" id="DownloadNFEntrada" name="DownloadNFEntrada"checked>
								<label class="form-check-label" for="DownloadNFEntrada">Sim</label>
							</div>
						</div>
						<div class="col-1 d-flex align-items-center "></div>
						<div class="col-2 d-flex align-items-center">
							<label for="periodo" class="col-form-label">Protocolar Entradas</label>
						</div>
						<div class="col-4 d-flex align-items-center ">
							<div class="form-check form-switch form-check-inline">
								<input class="form-check-input" type="checkbox" role="switch" id="ProtocolarNFEntrada" name="ProtocolarNFEntrada"checked>
								<label class="form-check-label" for="ProtocolarNFEntrada">Sim</label>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">Informar Simples Nacional</label>
						</div>
						<div class="col-2 d-flex align-items-center ">
							<div class="form-check form-switch form-check-inline">
								<input class="form-check-input" type="checkbox" role="switch" id="SimplesNacional" name="SimplesNacional">
								<label class="form-check-label" for="SimplesNacional">Sim</label>
							</div>
						</div>
						<div class="col-1 d-flex align-items-center "></div>
						<div class="col-2 d-flex align-items-center">
							<label class="col-form-label">Emitir NFS</label>
						</div>
						<div class="col-4 d-flex align-items-center ">
							<div class="form-check form-switch form-check-inline">
								<input class="form-check-input" type="checkbox" role="switch" id="EmitirNFS" name="EmitirNFS">
								<label class="form-check-label" for="EmitirNFS">Sim</label>
							</div>
						</div>
					</div>
				</div>
				<div id='divCertidao' style="display: block;">
					<hr class="my-3">
					<div class="container-fluid d-flex justify-content-center"><h6>Emissão da Certidão Negativa de Débitos - CND</h6></div>
					<div>
						<div class="row">
							<div class="col-3 d-flex align-items-center">
								<label class="col-form-label">Finalidade</label>
							</div>
							<div class="col-9 d-flex align-items-center ">
								<select class="form-select form-select-sm" id="FinalidadeCertidao">
									<option value=""></option>
									<option value="Financiamento - Contribuinte">Financiamento - Contribuinte</option>
									<option value="Juridico - Contribuinte">Juridico - Contribuinte</option>
									<option value="Licitação - Contribuinte">Licitação - Contribuinte</option>
									<option value="Transmissão - Contribuinte">Transmissão - Contribuinte</option>
								</select>
							</div>
						</div>
						<div class="row">
							<div class="col-3 d-flex align-items-center">
								<label class="col-form-label">Arquivo Excel com CNPJs</label>
							</div>
							<div class="col-9 d-flex align-items-center ">
								<input class="form-control form-control-sm" id="fileInputCertidao" type="file" accept=".xlsx, .xls">
							</div>
						</div>	
					</div>
				</div>
				<div id='divEmissaoNF' style="display: none;">
					<hr class="my-3">
					<div class="container-fluid d-flex justify-content-center"><h6>Emissão de Nota Fiscal de Serviço</h6></div>
					<div>
						<div class="row">
							<div class="col-3 d-flex align-items-center">
								<label class="col-form-label">Arquivo Notas</label>
							</div>
							<div class="col-9 d-flex align-items-center ">
								<input class="form-control form-control-sm" id="fileInputEmissaoNFS" type="file" accept=".pdf, .xlsx, .xls">
							</div>
						</div>	
					</div>
				</div>
			</div>
			
			<div class="card-body tab-pane" id="pills-automacao" role="tabpanel" aria-labelledby="pills-automacao-tab" tabindex="0">
				<div class="container-fluid d-flex justify-content-center"><h5>Configurações IPM</h5></div>
				<div>
					<div class="row">
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">IPM Login</label>
						</div>
						<div class="col-9 d-flex align-items-center ">
							<input type="text" class="form-control form-control-sm" id="IPMLogin" name="IPMLogin" placeholder="Usuário de acesso do contado no IPM" value="">
						</div>
					</div>
					
					<div class="row">
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">IPM Password</label>
						</div>
						<div class="col-9 d-flex align-items-center ">
							<input type="password" class="form-control form-control-sm" id="IPMPassword" name="IPMPassword" placeholder="Senha de acesso do contador no IPM" value="">
						</div>
					</div>
					<div class="row">
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">IPM Código Empresa</label>
						</div>
						<div class="col-9 d-flex align-items-center ">
							<input type="text" class="form-control form-control-sm" id="IPMCodigoLogin" name="IPMCodigoLogin" placeholder="Código de acesso IPM" value="">
						</div>
					</div>
					
					<div class="row">
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">Tipo Download Saidas</label>
						</div>
						<div class="col-3 d-flex align-items-center ">
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="ArquivoSaida" id="ArquivoSaidaXML" value="XML" checked>
								<label class="form-check-label" for="ArquivoSaidaXML">.xml</label>
							</div>
							<div class="form-check form-check-inline">
							  <input class="form-check-input" type="radio" name="ArquivoSaida" id="ArquivoSaidaTXT" value="TXT">
							  <label class="form-check-label" for="ArquivoSaidaTXT">.txt</label>
							</div>
							<div class="form-check form-check-inline">
							  <input class="form-check-input" type="radio" name="ArquivoSaida" id="ArquivoSaidaNenhum" value="Nenhum">
							  <label class="form-check-label" for="ArquivoSaidaNenhum">Nenhum</label>
							</div>
						</div>
						<div class="col-1 d-flex align-items-center"></div>
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">Protocolar Saidas</label>
						</div>
						<div class="col-2 d-flex align-items-center ">
							<select class="form-select form-select-sm" id="ProtocoloSaida" required>
								<option value="Todos">Todos</option>
								<option value="ISS">Com Recolhimento</option>
								<option value="Nenhum">Nenhum</option>
							</select>
						</div>

					</div>
					<div class="row">
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">Tipo Download Entradas</label>
						</div>
						<div class="col-3 d-flex align-items-center ">
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="ArquivoEntrada" id="ArquivoEntradaXML" value="XML" checked>
								<label class="form-check-label" for="ArquivoEntradaXML">.xml</label>
							</div>
							<div class="form-check form-check-inline">
							  <input class="form-check-input form-sm" type="radio" name="ArquivoEntrada" id="ArquivoEntradaTXT" value="TXT">
							  <label class="form-check-label form-sm" for="ArquivoEntradaTXT">.txt</label>
							</div>
							<div class="form-check form-check-inline">
							  <input class="form-check-input form-sm" type="radio" name="ArquivoEntrada" id="ArquivoEntradaNenhum" value="Nenhum">
							  <label class="form-check-label form-sm" for="ArquivoEntradaNenhum">Nenhum</label>
							</div>
						</div>
						<div class="col-1 d-flex align-items-center"></div>
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">Protocolar Entradas</label>
						</div>
						<div class="col-2 d-flex align-items-center ">
							<select class="form-select form-select-sm" id="ProtocoloEntrada" required>
								<option value="Todos">Todos</option>
								<option value="ISS">Com Recolhimento</option>
								<option value="Nenhum">Nenhum</option>
							</select>
						</div>
					</div>
					
					<div class="row mb-1">
						<div class="col-3 d-flex align-items-center">
							<label class="col-form-label">Código Serviço Emissão NFS</label>
						</div>
						<div class="col-9 d-flex align-items-center ">
							<input type="text" class="form-control form-control-sm" id="CodigoServico" name="CodigoServico" placeholder="Código de serviço para emissão da Nota Fiscal" value="">
						</div>
					</div>
					
					<div class="row mb-1">
						<div class="col-3 d-flex align-items-start">
							<label class="col-form-label">Observação na Emissao NFS</label>
						</div>
						<div class="col-9 d-flex align-items-center">
							  <textarea class="form-control form-control-sm" placeholder="Observação para emissão de NFS" rows="6" id="ObservacaoNFS"></textarea>
						</div>
					</div>
					<div class="row mb-1">
						<div class="col-3 d-flex align-items-start">
							<label class="col-form-label">Observação Financeira na NFS</label>
						</div>
						<div class="col-9 d-flex align-items-center">
							  <textarea class="form-control form-control-sm" placeholder="Observação financeira na NFS" rows="5" id="ObservacaoFinanceira"></textarea>
						</div>
					</div>
				</div>
			</div>
			
			<div class="card-body tab-pane" id="pills-dominio" role="tabpanel" aria-labelledby="pills-dominio-tab" tabindex="0">
				<div class="container-fluid d-flex justify-content-center"><h5>Configurações Dominio</h5></div>
				<div>
					<div class="row">
						<div class="col-2 d-flex align-items-center">
							<label class="col-form-label">Login</label>
						</div>
						<div class="col-10 d-flex align-items-center ">
							<input type="text" class="form-control form-control-sm" id="DominioLogin" name="DominioLogin" placeholder="Usuário do Domínio" value="">
						</div>
						
					</div>
					<div class="row">
						<div class="col-2 d-flex align-items-center">
							<label class="col-form-label">Password</label>
						</div>
						<div class="col-10 d-flex align-items-center ">
							<input type="password" class="form-control form-control-sm" id="DominioPassword" name="DominioPassword" placeholder="Senha do Domínio" value="">
						</div>
					</div>
					<div class="row">
						<div class="col-2 d-flex align-items-center">
							<label class="col-form-label">Domínio Web</label>
						</div>
						<div class="col-10 d-flex align-items-center ">
							<div class="form-check form-switch form-check-inline">
								<input class="form-check-input" type="checkbox" role="switch" id="DominioWeb" name="DominioWeb">
								<label class="form-check-label" for="DominioWeb">Não</label>
							</div>
						</div>
					</div>
					<hr class="my-3">
					<div class="row">
						<div class="col-2 d-flex align-items-center">
							<label class="col-form-label">Arquivo clientes</label>
						</div>
						<div class="col-10 d-flex align-items-center ">
							<button class="btn btn-outline-success w-100" type="botton" onclick="excelClicked()">Gerar arquivo Excel dos Clientes Ativos</button>
						</div>
					</div>
				</div>
			</div>
			
			
		</div>
		<div class="position-fixed d-flex align-items-center bottom-0 end-0 mb-1 me-1 bd-mode-toggle">
		  <button class="btn btn-primary  py-4 rounded-0 " type="button" onclick="startClicked()">
			Iniciar  <i class="bi bi-play-fill"></i>
		  </button>
		</div>
	</div>
	
	
	
	
	<div class="modal" id="perfilModal" tabindex="-1" aria-labelledby="perfilModalTitle" aria-hidden="true">
		<!--div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"-->
		<div class="modal-dialog modal-dialog-scrollable">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="perfilModalTitle">Cadastro de Perfil</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="row">
						<form class="d-flex" id="myFormModalPerfil">
							<input class="form-control form-control-sm me-2" type="text" id="novoPerfil" placeholder="Nome do novo perfil">
							<button class="btn btn-primary btn-sm" type="button" id="addPerfillLista" onclick="addNovoPerfilClicked()">adicionar</button>
						</form>
					</div>
					<hr>
					<div class="row">
						<table class="table table-sm table-striped">
							<thead>
								<tr>
									<th scope="col-2">#</th>
									<th scope="col-8">Perfil</th>
									<th scope="col-2"><div class="d-flex justify-content-center">Ação</div></th>
								</tr>
							</thead>
							<tbody id="myTablePerfil" class="table-group-divider">
								<tr>
									<th class="col-2" scope="row">1</th>
									<td class="col-8">Perfil A</td>
									<td class="col-2"><div class="d-flex justify-content-center"><button type="button" class="btn btn-danger btn-sm "><i class="bi bi-trash"></i></button></div></td>
								</tr>
								<tr>
									<th class="col-2" scope="row">5</th>
									<td class="col-8">Perfil B</td>
									<td class="col-2"><div class="d-flex justify-content-center"><button type="button" class="btn btn-danger btn-sm"><i class="bi bi-trash"></i></button></div></td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancelar</button>
					<button type="button" class="btn btn-primary btn-sm" data-bs-dismiss="modal" onclick="atualizaPerfil()">Salvar</button>
				</div>
			</div>
		</div>
	</div>
	
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	
	<!--script>
		function downloadFile() {
		  var fileInput = document.getElementById('fileInput');
		  var file = fileInput.files[0];
		  var fileName = file.name;
		  var fileExtension = fileName.split('.').pop(); // Obtém a extensão do arquivo
		  var currentDate = new Date();
		  var formattedDate = currentDate.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit', second: '2-digit' });
		  var newFileName = formattedDate.replace(/[^\d]/g, '') + '.' + fileExtension; // Novo nome do arquivo
		  
		  var downloadLink = document.createElement('a');
		  downloadLink.href = URL.createObjectURL(file);
		  downloadLink.download = newFileName;
		  downloadLink.click();

		  var fileInfoCertidaoExcelDiv = document.getElementById('fileInfoCertidaoExcel');
		  fileInfoCertidaoExcelDiv.value = newFileName; // Define o valor sem exibir para o usuário
		  fileInfoCertidaoExcelDiv.style.display = 'block'; // Torna a div visível ao concluir o download
		}
	</script-->
	
	
	<!-- Javascrit da pagina -->
    <script>
		
	
	  var ckDominioWeb = document.getElementById('DominioWeb');
	  var labelDominioWeb = document.querySelector('label[for="DominioWeb"]');

	  ckDominioWeb.addEventListener('change', function() {
		if (this.checked) {
		  labelDominioWeb.textContent = 'Sim';
		} else {
		  labelDominioWeb.textContent = 'Não';
		}
	  });
	  
	  var ckExibirClientes = document.getElementById('ExibirClientes');
	  var labelExibirClientes = document.querySelector('label[for="ExibirClientes"]');

	  ckExibirClientes.addEventListener('change', function() {
		if (this.checked) {
		  labelExibirClientes.textContent = 'Sim';
		} else {
		  labelExibirClientes.textContent = 'Não';
		}
	  });
	  var ckFiltroClientes = document.getElementById('FiltrarClientesPendentes');
	  var labelFiltro = document.querySelector('label[for="FiltrarClientesPendentes"]');

	  ckFiltroClientes.addEventListener('change', function() {
		if (this.checked) {
		  labelFiltro.textContent = 'Clientes pendentes';
		} else {
		  labelFiltro.textContent = 'Todos os clientes';
		}
	  });
	  
	  var ckDownloadNFSaida = document.getElementById('DownloadNFSaida');
	  var labelDownloadNFSaida = document.querySelector('label[for="DownloadNFSaida"]');

	  ckDownloadNFSaida.addEventListener('change', function() {
		if (this.checked) {
		  labelDownloadNFSaida.textContent = 'Sim';
		} else {
		  labelDownloadNFSaida.textContent = 'Não';
		}
	  });
	  
	  var ckProtocolarNFSaida = document.getElementById('ProtocolarNFSaida');
	  var labelProtocolarNFSaida = document.querySelector('label[for="ProtocolarNFSaida"]');

	  ckProtocolarNFSaida.addEventListener('change', function() {
		if (this.checked) {
		  labelProtocolarNFSaida.textContent = 'Sim';
		} else {
		  labelProtocolarNFSaida.textContent = 'Não';
		}
	  });
	  
	  var ckDownloadNFEntrada = document.getElementById('DownloadNFEntrada');
	  var labelDownloadNFEntrada = document.querySelector('label[for="DownloadNFEntrada"]');

	  ckDownloadNFEntrada.addEventListener('change', function() {
		if (this.checked) {
		  labelDownloadNFEntrada.textContent = 'Sim';
		} else {
		  labelDownloadNFEntrada.textContent = 'Não';
		}
	  });
	  
	  var ckProtocolarNFEntrada = document.getElementById('ProtocolarNFEntrada');
	  var labelProtocolarNFEntrada = document.querySelector('label[for="ProtocolarNFEntrada"]');

	  ckProtocolarNFEntrada.addEventListener('change', function() {
		if (this.checked) {
		  labelProtocolarNFEntrada.textContent = 'Sim';
		} else {
		  labelProtocolarNFEntrada.textContent = 'Não';
		}
	  });
	  
	  var ckSimplesNacional = document.getElementById('SimplesNacional');
	  var labelSimplesNacional = document.querySelector('label[for="SimplesNacional"]');

	  ckSimplesNacional.addEventListener('change', function() {
		if (this.checked) {
		  labelSimplesNacional.textContent = 'Sim';
		} else {
		  labelSimplesNacional.textContent = 'Não';
		}
	  });
	  
	  var ckEmitirNFS = document.getElementById('EmitirNFS');
	  var labelEmitirNFS = document.querySelector('label[for="EmitirNFS"]');
	  var divEmissaoNF = document.getElementById("divEmissaoNF");
	  var divCertidao = document.getElementById("divCertidao");

	  ckEmitirNFS.addEventListener('change', function() {
		if (this.checked) {
		  labelEmitirNFS.textContent = 'Sim';
		  divEmissaoNF.style.display = "block";
		  divCertidao.style.display = "none";
		} else {
		  labelEmitirNFS.textContent = 'Não';
		  divEmissaoNF.style.display = "none";
		  divCertidao.style.display = "block";
		}
	  });
	  
	  
	var selectPerfil = document.getElementById('Perfil');

	// Define a função que será executada quando o valor selecionado for alterado
	function perfilChanged() {
	  var selectedValue = selectPerfil.value;
	  //alert(selectedValue);
	  changedPerfil(selectedValue);
	}

	// Adiciona um ouvinte de evento para o evento 'change' do <select>
	selectPerfil.addEventListener('change', perfilChanged);
	  
	
		
	//  document.addEventListener("DOMContentLoaded", function () {
	//	  var cpf = formatarInput('Periodo','00/0000');
	//	});
		
		
	</script>
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.8/inputmask.min.js"></script>	  
	<script>
		$(document).ready(function() {
			Inputmask("99999-999").mask("#Periodo");
		});
	</script>
	
	<!-- Contrata o Menu do cabeçalho -->
	<script>
		document.querySelectorAll('.dropdown-item').forEach(function(item) {
		item.addEventListener('click', function(event) {
			event.preventDefault();
			var target = document.querySelector(this.getAttribute('data-bs-target'));
			var dropdown = document.querySelector('.dropdown');
			var dropdownMenu = document.querySelector('.dropdown-menu');
			if (target) {
				var tabTrigger = new bootstrap.Tab(target);
				tabTrigger.show();
			}

			  dropdown.classList.remove('show');
			  dropdownMenu.classList.remove('show');
			});
		});
	
		var triggerTabList = [].slice.call(document.querySelectorAll('#pills-tab a'))
		triggerTabList.forEach(function (triggerEl) {
		  var tabTrigger = new bootstrap.Tab(triggerEl)

		  triggerEl.addEventListener('click', function (event) {
			event.preventDefault()
			tabTrigger.show()
		  })
		})
	
	</script>
    
</body>
</html>
